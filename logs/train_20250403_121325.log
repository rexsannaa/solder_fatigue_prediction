2025-04-03 12:13:25,855 - __main__ - INFO - 載入配置文件: configs/model_config.yaml
2025-04-03 12:13:25,873 - __main__ - INFO - 載入訓練配置文件: configs/train_config.yaml
2025-04-03 12:13:25,907 - __main__ - INFO - 使用計算設備: cpu
2025-04-03 12:13:25,923 - __main__ - INFO - 載入資料: data/raw/Training_data_warpage_final_20250321_v1.2.csv
2025-04-03 12:13:25,923 - src.data.preprocess - INFO - 正在讀取資料: data/raw/Training_data_warpage_final_20250321_v1.2.csv
2025-04-03 12:13:25,984 - src.data.preprocess - INFO - 時間序列資料形狀: (81, 4, 2)
2025-04-03 12:13:25,986 - src.data.preprocess - INFO - 訓練集: 56 樣本, 驗證集: 12 樣本, 測試集: 13 樣本
2025-04-03 12:13:25,986 - __main__ - INFO - 創建資料載入器，批次大小: 8
2025-04-03 12:13:25,988 - src.data.dataset - INFO - 創建資料載入器完成，批次大小=8，訓練集批次數=7，驗證集批次數=2，測試集批次數=2
2025-04-03 12:13:25,989 - __main__ - INFO - 資料集大小 - 訓練: 56, 驗證: 12, 測試: 13
2025-04-03 12:13:25,989 - __main__ - INFO - 創建模型: hybrid
2025-04-03 12:13:25,991 - src.models.pinn - INFO - 初始化PINNModel，輸入維度: 5, 隱藏層: [64, 32, 16], 使用物理層: True
2025-04-03 12:13:25,995 - src.models.lstm - INFO - 初始化LSTMModel，輸入維度: 2, 隱藏層大小: 64, LSTM層數: 2, 雙向: True, 使用注意力: True
2025-04-03 12:13:26,002 - src.models.hybrid_model - INFO - 初始化HybridPINNLSTMModel: 靜態特徵維度=5, 時間序列特徵維度=2, 時間步數=4, 融合維度=32
2025-04-03 12:13:26,004 - __main__ - INFO - 模型參數總數: 154,181
2025-04-03 12:13:28,037 - src.training.losses - INFO - 初始化HybridLoss: lambda_physics=0.01, lambda_consistency=0.01, a=55.83, b=-2.259
2025-04-03 12:13:28,037 - src.training.losses - INFO - 初始化AdaptiveHybridLoss: physics權重從0.01增加到0.5, consistency權重從0.01增加到0.3, 在50個輪次內達到最大值
2025-04-03 12:13:28,038 - src.training.trainer - INFO - 初始化LearningRateScheduler: mode=cosine, 初始學習率=[0.001]
2025-04-03 12:13:28,039 - src.training.callbacks - INFO - 初始化ModelCheckpoint: 保存目錄=outputs\HybridPINNLSTM_20250403_121328\checkpoints, 保存頻率=5, 只保存最佳=False, 監控指標=val_loss, 模式=min
2025-04-03 12:13:28,040 - src.training.callbacks - INFO - 初始化LossHistory: 保存路徑=outputs\HybridPINNLSTM_20250403_121328\history.json, 保存頻率=1
2025-04-03 12:13:28,046 - src.training.trainer - INFO - 初始化EarlyStopping: patience=20, mode=min
2025-04-03 12:13:28,047 - src.training.trainer - INFO - 初始化Trainer: model=HybridPINNLSTMModel, device=cpu
2025-04-03 12:13:28,047 - __main__ - INFO - 開始訓練 - 模型: HybridPINNLSTM, 輪次: 200
2025-04-03 12:13:28,047 - src.training.trainer - INFO - 開始訓練: epochs=200, 訓練批次數=7, 驗證批次數=2
2025-04-03 12:13:28,086 - __main__ - ERROR - 執行過程中發生錯誤: pow() received an invalid combination of arguments - got (float, float), but expected one of:
 * (Tensor input, Tensor exponent, *, Tensor out = None)
 * (Number self, Tensor exponent, *, Tensor out = None)
 * (Tensor input, Number exponent, *, Tensor out = None)
Traceback (most recent call last):
  File "C:\Users\a\Desktop\畢業論文\CAE\code\pinnlstm_code_sacq_5\scripts\train.py", line 598, in <module>
    main()
  File "C:\Users\a\Desktop\畢業論文\CAE\code\pinnlstm_code_sacq_5\scripts\train.py", line 533, in main
    history = train_model(model, dataloaders, config, device, output_dir, use_physics=not args.no_physics)
  File "C:\Users\a\Desktop\畢業論文\CAE\code\pinnlstm_code_sacq_5\scripts\train.py", line 322, in train_model
    history = trainer.train(
  File "C:\Users\a\Desktop\畢業論文\CAE\code\pinnlstm_code_sacq_5\src\training\trainer.py", line 264, in train
    train_loss = self._train_epoch(train_loader)
  File "C:\Users\a\Desktop\畢業論文\CAE\code\pinnlstm_code_sacq_5\src\training\trainer.py", line 360, in _train_epoch
    losses = self.loss_fn(outputs, targets)
  File "C:\Users\a\anaconda3\envs\solder_fatigue\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\a\anaconda3\envs\solder_fatigue\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\a\Desktop\畢業論文\CAE\code\pinnlstm_code_sacq_5\src\training\losses.py", line 208, in forward
    physics_loss = self.physics_loss(
  File "C:\Users\a\anaconda3\envs\solder_fatigue\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\a\anaconda3\envs\solder_fatigue\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\a\Desktop\畢業論文\CAE\code\pinnlstm_code_sacq_5\src\training\losses.py", line 105, in forward
    torch.ones_like(nf_pred) * torch.pow(self.a, 1/self.b),
TypeError: pow() received an invalid combination of arguments - got (float, float), but expected one of:
 * (Tensor input, Tensor exponent, *, Tensor out = None)
 * (Number self, Tensor exponent, *, Tensor out = None)
 * (Tensor input, Number exponent, *, Tensor out = None)

