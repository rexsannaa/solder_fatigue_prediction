2025-04-03 16:58:50,303 - __main__ - INFO - === 開始模型評估 ===
2025-04-03 16:58:50,306 - __main__ - INFO - 命令行參數: Namespace(model_path='outputs/models/best_model.pt', config='configs/model_config.yaml', data='data/raw/Training_data_warpage_final_20250321_v1.2.csv', output_dir='outputs/evaluation', model_type='hybrid', device=None, batch_size=16, visualize=True, debug=False)
2025-04-03 16:58:50,318 - __main__ - INFO - 成功載入配置文件: configs/model_config.yaml
2025-04-03 16:58:50,318 - __main__ - INFO - 使用計算設備: cpu
2025-04-03 16:58:50,323 - __main__ - INFO - 創建混合PINN-LSTM模型
2025-04-03 16:58:50,327 - src.models.pinn - INFO - 初始化PINNModel，輸入維度: 5, 隱藏層: [64, 32, 16], 使用物理層: True
2025-04-03 16:58:50,330 - src.models.lstm - INFO - 初始化LSTMModel，輸入維度: 2, 隱藏層大小: 64, LSTM層數: 2, 雙向: True, 使用注意力: True
2025-04-03 16:58:50,336 - src.models.hybrid_model - INFO - 初始化HybridPINNLSTMModel: 靜態特徵維度=5, 時間序列特徵維度=2, 時間步數=4, 融合維度=32
2025-04-03 16:58:50,336 - __main__ - INFO - 從 outputs/models/best_model.pt 載入模型權重
2025-04-03 16:58:50,351 - __main__ - INFO - 從model_state_dict載入模型權重
2025-04-03 16:58:50,352 - __main__ - INFO - 模型載入成功，移至 cpu 設備
2025-04-03 16:58:51,169 - __main__ - INFO - 從 data/raw/Training_data_warpage_final_20250321_v1.2.csv 載入數據
2025-04-03 16:58:51,169 - src.data.preprocess - INFO - 正在讀取資料: data/raw/Training_data_warpage_final_20250321_v1.2.csv
2025-04-03 16:58:51,209 - __main__ - INFO - 標準化特徵: ['Die', 'stud', 'mold', 'PCB', 'Unit_warpage']
2025-04-03 16:58:51,211 - __main__ - INFO - 準備時間序列數據
2025-04-03 16:58:51,212 - src.data.preprocess - INFO - 時間序列資料形狀: (81, 4, 2)
2025-04-03 16:58:51,212 - __main__ - INFO - 數據載入完成: 81 個樣本
2025-04-03 16:58:51,213 - __main__ - INFO - 創建數據載入器成功: 81 個樣本，批次大小 16
2025-04-03 16:58:51,213 - __main__ - INFO - 開始評估模型性能
2025-04-03 16:58:51,239 - __main__ - INFO - 評估完成: 81 個預測
2025-04-03 16:58:51,239 - __main__ - INFO - 計算評估指標
2025-04-03 16:58:51,314 - __main__ - INFO - 驗證物理約束
2025-04-03 16:58:51,315 - src.utils.physics - WARNING - 物理約束驗證失敗! 有 76 個樣本違反約束
2025-04-03 16:58:51,315 - src.utils.physics - WARNING - 違反約束的樣本索引: [ 0  1  2  3  4  6  7  8  9 10 11 12 13 14 15 16 18 19 20 21 22 23 24 25
 26 27 28 29 30 31 32 33 34 35 37 38 39 40 41 42 43 44 46 47 48 49 50 52
 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76
 77 78 79 80]
2025-04-03 16:58:51,316 - src.utils.physics - WARNING - 違反約束的樣本相對殘差: [ 348.78134    99.27432    51.738964  920.85144    97.54012  1219.1604
   98.34858    46.656517  830.6973     98.104904   61.780506 1032.1226
   98.21457    39.2537    766.48486    98.41632  1775.4388     96.06686
   34.110126 1367.0883     96.3441     34.055416 1098.6149     98.78642
   82.35914   153.51346    99.25564   355.03915    37.217445   98.52256
  738.2284    140.35909    97.54774   205.61346   400.06094   164.4009
   51.54557    97.79214   513.3843     39.04127    98.6047    181.71327
   96.375496  460.19226    32.572716   97.604195  991.33435    99.028465
   82.076744   95.1653     98.36397  2965.2942     97.36764    97.69319
 7855.2017     96.01941    97.885475 3613.3784     98.85782    98.33669
 1928.2234     98.64053    97.47197  3417.405      97.96046    96.674774
 2375.7024     99.29146    99.169174 3405.8345     98.6407     98.53089
 4346.1953     97.81202    97.48634  1638.3273  ]
2025-04-03 16:58:51,317 - __main__ - WARNING - 物理約束驗證失敗, 有 76 個樣本違反約束
2025-04-03 16:58:51,330 - __main__ - INFO - 預測結果保存到: outputs/evaluation\predictions.csv
2025-04-03 16:58:51,332 - __main__ - INFO - 評估指標保存到: outputs/evaluation\metrics.csv
2025-04-03 16:58:51,337 - __main__ - INFO - 違反物理約束的樣本保存到: outputs/evaluation\violated_samples.csv
2025-04-03 16:58:51,337 - __main__ - INFO - 生成視覺化結果
2025-04-03 16:58:51,338 - __main__ - INFO - 繪製預測vs真實值圖
2025-04-03 16:58:52,037 - src.utils.visualization - INFO - 圖像已保存至: outputs/evaluation\visualizations\prediction_vs_true.png
2025-04-03 16:58:52,426 - src.utils.visualization - INFO - 圖像已保存至: outputs/evaluation\visualizations\prediction_vs_true.png
2025-04-03 16:58:52,445 - __main__ - INFO - 生成詳細視覺化結果
2025-04-03 16:58:53,030 - src.utils.visualization - INFO - 圖像已保存至: outputs/evaluation\visualizations\pred_vs_true.png
2025-04-03 16:58:53,419 - src.utils.visualization - INFO - 圖像已保存至: outputs/evaluation\visualizations\pred_vs_true.png
2025-04-03 16:58:54,717 - src.utils.visualization - INFO - 圖像已保存至: outputs/evaluation\visualizations\error_analysis.png
2025-04-03 16:58:55,805 - src.utils.visualization - INFO - 圖像已保存至: outputs/evaluation\visualizations\physics_validation.png
2025-04-03 16:58:56,177 - src.utils.visualization - INFO - 已生成 5 個視覺化圖表於 outputs/evaluation\visualizations
2025-04-03 16:58:56,178 - __main__ - INFO - 視覺化結果保存到: outputs/evaluation\visualizations
2025-04-03 16:58:56,178 - __main__ - INFO - === 評估完成，耗時: 5.88秒 ===
